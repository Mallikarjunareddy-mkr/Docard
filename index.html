<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Web File Manager</title>
<style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; }
    .home, .manager { display: none; padding: 20px; }
    .home.active, .manager.active { display: block; }
    button { padding:10px 20px; margin:10px; cursor:pointer; }
    #sidebar { width: 200px; float:left; border-right:1px solid #ccc; height: calc(100vh - 40px); padding: 10px; box-sizing:border-box; }
    #main { margin-left: 220px; padding: 10px; box-sizing:border-box; }
    ul { list-style: none; padding:0; }
    li { padding:5px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; }
    .file-actions button { margin-left:5px; }
</style>
</head>
<body>

<!-- Home Page -->
<div class="home active">
    <h1>Web File Manager</h1>
    <button onclick="openManager('local')">Local Storage</button>
    <button onclick="openManager('cloud')">Cloud Storage</button>
</div>

<!-- File Manager -->
<div class="manager">
    <button onclick="goHome()">â¬… Back</button>
    <h2 id="managerTitle"></h2>
    <div id="sidebar">
        <h3>Folders</h3>
        <button onclick="createFolder()">+ New Folder</button>
        <ul id="folderList"></ul>
    </div>
    <div id="main">
        <h3>Files</h3>
        <button onclick="uploadFile()">Upload File</button>
        <ul id="fileList"></ul>
    </div>
</div>

<input type="file" id="fileInput" style="display:none;" onchange="handleFileUpload(event)">

<script>
// State
let currentManager = '';
let currentFolder = '/';
if(!localStorage.getItem('files')) localStorage.setItem('files', JSON.stringify({ '/': {} }));

function openManager(type){
    currentManager = type;
    document.querySelector('.home').classList.remove('active');
    document.querySelector('.manager').classList.add('active');
    document.getElementById('managerTitle').innerText = type === 'local' ? 'Local Storage' : 'Cloud Storage';
    if(type === 'local') loadLocalStorage();
    else alert('Cloud Storage integration coming soon!');
}

function goHome(){
    document.querySelector('.home').classList.add('active');
    document.querySelector('.manager').classList.remove('active');
}

// Local Storage Functions
function loadLocalStorage(){
    const files = JSON.parse(localStorage.getItem('files'));
    const folderList = document.getElementById('folderList');
    const fileList = document.getElementById('fileList');
    folderList.innerHTML = '';
    fileList.innerHTML = '';

    for(let name in files[currentFolder]){
        if(typeof files[currentFolder][name] === 'object'){ // Folder
            let li = document.createElement('li');
            li.innerHTML = `<span onclick="openFolder('${name}')">${name}</span>
                            <span class="file-actions"><button onclick="deleteFolder('${name}')">Delete</button></span>`;
            folderList.appendChild(li);
        } else { // File
            let li = document.createElement('li');
            li.innerHTML = `${name} <span class="file-actions">
                                <button onclick="downloadFile('${name}')">Download</button>
                                <button onclick="deleteFile('${name}')">Delete</button>
                            </span>`;
            fileList.appendChild(li);
        }
    }
}

function createFolder(){
    let name = prompt('Folder Name:');
    if(!name) return;
    let files = JSON.parse(localStorage.getItem('files'));
    if(files[currentFolder][name]){
        alert('Folder already exists!');
        return;
    }
    files[currentFolder][name] = {};
    localStorage.setItem('files', JSON.stringify(files));
    loadLocalStorage();
}

function openFolder(name){
    currentFolder = name;
    loadLocalStorage();
}

function deleteFolder(name){
    if(!confirm(`Delete folder "${name}" and all its contents?`)) return;
    const files = JSON.parse(localStorage.getItem('files'));
    delete files[currentFolder][name];
    localStorage.setItem('files', JSON.stringify(files));
    loadLocalStorage();
}

function uploadFile(){
    document.getElementById('fileInput').click();
}

function handleFileUpload(event){
    const file = event.target.files[0];
    const reader = new FileReader();
    reader.onload = function(){
        let files = JSON.parse(localStorage.getItem('files'));
        files[currentFolder][file.name] = reader.result;
        localStorage.setItem('files', JSON.stringify(files));
        loadLocalStorage();
    };
    reader.readAsDataURL(file);
}

function downloadFile(name){
    const files = JSON.parse(localStorage.getItem('files'));
    const a = document.createElement('a');
    a.href = files[currentFolder][name];
    a.download = name;
    a.click();
}

function deleteFile(name){
    if(!confirm(`Delete file "${name}"?`)) return;
    const files = JSON.parse(localStorage.getItem('files'));
    delete files[currentFolder][name];
    localStorage.setItem('files', JSON.stringify(files));
    loadLocalStorage();
}
</script>

</body>
</html>
