<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web File Manager</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #f8f9fa; }
    header { background: #343a40; color: #fff; padding: 12px; text-align: center; }
    .layout { display: flex; height: calc(100vh - 50px); }/* Sidebar */
.sidebar { width: 220px; background: #212529; color: white; padding: 15px; display: flex; flex-direction: column; }
.sidebar h2 { font-size: 18px; margin-bottom: 15px; }
.nav-btn { background: none; border: none; color: white; text-align: left; padding: 10px; margin: 2px 0; cursor: pointer; font-size: 15px; border-radius: 6px; }
.nav-btn:hover { background: #495057; }

/* Main content */
.main { flex: 1; padding: 15px; display: flex; flex-direction: column; }
.toolbar { margin-bottom: 10px; }
.toolbar button { margin-right: 10px; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; background: #007bff; color: white; }
.toolbar button:hover { background: #0056b3; }

/* File area */
.file-area { flex: 1; background: white; border: 1px solid #dee2e6; border-radius: 6px; padding: 10px; display: grid; grid-template-columns: repeat(auto-fill, 120px); gap: 15px; align-content: flex-start; overflow-y: auto; }
.file-item { text-align: center; cursor: pointer; position: relative; }
.file-checkbox { position: absolute; top: 5px; left: 5px; }
.file-icon { font-size: 40px; margin-bottom: 5px; color: #6c757d; }
.file-name { font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Folder tree placeholder */
.folder-tree { margin-bottom: 20px; font-size: 14px; color: #ddd; }
.folder { margin-left: 15px; cursor: pointer; }

/* Context Menu */
.context-menu { position: absolute; background: white; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); display: none; z-index: 1000; }
.context-menu button { display: block; width: 100%; padding: 8px 12px; border: none; background: none; text-align: left; cursor: pointer; }
.context-menu button:hover { background: #f1f1f1; }

  </style>
</head>
<body>
  <header>
    <h1>Web File Manager</h1>
  </header>  <div class="layout">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2>Navigation</h2>
      <button class="nav-btn" onclick="goHome()">🏠 Home</button>
      <button class="nav-btn" onclick="showSection('local')">💻 Local Storage</button>
      <button class="nav-btn" onclick="showSection('cloud')">☁️ Cloud Storage</button>
      <div class="folder-tree" id="folderTree">
        <p><strong>Folders</strong></p>
        <div class="folder" onclick="openFolder('/')">📁 Root</div>
      </div>
    </div><!-- Main Content -->
<div class="main">
  <!-- Toolbar -->
  <div class="toolbar">
    <button onclick="uploadFiles()">⬆️ Upload</button>
    <button onclick="createFolder()">📂 New Folder</button>
    <button onclick="deleteSelected()">🗑️ Delete</button>
    <button onclick="downloadSelected()">⬇️ Download</button>
    <input type="file" id="fileInput" multiple style="display:none">
  </div>

  <!-- File Grid -->
  <div class="file-area" id="fileArea"></div>
</div>

  </div>  <!-- Context Menu -->  <div class="context-menu" id="contextMenu">
    <button onclick="renameFile()">✏️ Rename</button>
    <button onclick="deleteFile()">🗑️ Delete</button>
    <button onclick="downloadFile()">⬇️ Download</button>
  </div>  <script>
    let db;
    let currentPath = '/';
    let contextTarget = null;

    // Init IndexedDB
    function initDB() {
      const request = indexedDB.open('FileManagerDB', 3);

      request.onupgradeneeded = function(e) {
        db = e.target.result;
        if (!db.objectStoreNames.contains('files')) {
          db.createObjectStore('files', { keyPath: 'id' });
        }
      };

      request.onsuccess = function(e) {
        db = e.target.result;
        renderFiles();
      };
    }

    function goHome() {
      currentPath = '/';
      renderFiles();
    }

    function showSection(section) {
      if (section === 'cloud') {
        alert('Cloud integration coming soon!');
      } else {
        currentPath = '/';
        renderFiles();
      }
    }

    function uploadFiles() {
      const input = document.getElementById('fileInput');
      input.click();
      input.onchange = function() {
        const files = input.files;
        for (let f of files) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const transaction = db.transaction(['files'], 'readwrite');
            const store = transaction.objectStore('files');
            const id = currentPath + f.name;
            store.put({ id, name: f.name, path: currentPath, type: 'file', data: e.target.result });
            transaction.oncomplete = renderFiles;
          };
          reader.readAsDataURL(f);
        }
      };
    }

    function createFolder() {
      const name = prompt('Enter folder name:');
      if (!name) return;
      const transaction = db.transaction(['files'], 'readwrite');
      const store = transaction.objectStore('files');
      const id = currentPath + name + '/';
      store.put({ id, name, path: currentPath, type: 'folder' });
      transaction.oncomplete = renderFiles;
    }

    function openFolder(path) {
      currentPath = path;
      renderFiles();
    }

    function renderFiles() {
      const transaction = db.transaction(['files'], 'readonly');
      const store = transaction.objectStore('files');
      const request = store.getAll();

      request.onsuccess = function() {
        const area = document.getElementById('fileArea');
        area.innerHTML = '';
        request.result.filter(item => item.path === currentPath).forEach(file => {
          const div = document.createElement('div');
          div.className = 'file-item';
          div.innerHTML = `
            <input type="checkbox" class="file-checkbox" data-id="${file.id}">
            <div class="file-icon">${file.type === 'folder' ? '📁' : '📄'}</div>
            <div class="file-name">${file.name}</div>
          `;
          div.onclick = (e) => {
            if (e.target.tagName === 'INPUT') return; // checkbox click
            if (file.type === 'folder') openFolder(file.id);
            else downloadFile(file.id);
          };
          div.oncontextmenu = (e) => {
            e.preventDefault();
            contextTarget = file;
            showContextMenu(e.pageX, e.pageY);
          };
          area.appendChild(div);
        });
      };
    }

    function showContextMenu(x, y) {
      const menu = document.getElementById('contextMenu');
      menu.style.left = x + 'px';
      menu.style.top = y + 'px';
      menu.style.display = 'block';
    }

    window.onclick = function() {
      document.getElementById('contextMenu').style.display = 'none';
    };

    function renameFile() {
      if (!contextTarget) return;
      const newName = prompt('Enter new name:', contextTarget.name);
      if (!newName) return;
      const transaction = db.transaction(['files'], 'readwrite');
      const store = transaction.objectStore('files');
      store.delete(contextTarget.id);
      const newId = contextTarget.path + newName + (contextTarget.type === 'folder' ? '/' : '');
      contextTarget.name = newName;
      contextTarget.id = newId;
      store.put(contextTarget);
      transaction.oncomplete = renderFiles;
    }

    function deleteFile() {
      if (!contextTarget) return;
      const transaction = db.transaction(['files'], 'readwrite');
      const store = transaction.objectStore('files');
      store.delete(contextTarget.id);
      transaction.oncomplete = renderFiles;
    }

    function deleteSelected() {
      const checkboxes = document.querySelectorAll('.file-checkbox:checked');
      const transaction = db.transaction(['files'], 'readwrite');
      const store = transaction.objectStore('files');
      checkboxes.forEach(cb => store.delete(cb.dataset.id));
      transaction.oncomplete = renderFiles;
    }

    function downloadFile(id = null) {
      const fileId = id || (contextTarget ? contextTarget.id : null);
      if (!fileId) return;
      const transaction = db.transaction(['files'], 'readonly');
      const store = transaction.objectStore('files');
      const request = store.get(fileId);
      request.onsuccess = function() {
        const file = request.result;
        if (file && file.type === 'file') {
          const a = document.createElement('a');
          a.href = file.data;
          a.download = file.name;
          a.click();
        }
      };
    }

    function downloadSelected() {
      const checkboxes = document.querySelectorAll('.file-checkbox:checked');
      checkboxes.forEach(cb => downloadFile(cb.dataset.id));
    }

    window.onload = initDB;
  </script></body>
</html>
